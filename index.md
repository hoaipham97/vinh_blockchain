
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>House Renting</title>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css">
<!-- Style CSS -->
<link rel="stylesheet" href="stylesheets/style.css">
</head>
<body>
<!-- Preloader -->

<!-- ##### Header Area Start ##### -->
<header class="header-area">
    <!-- Top Header Area -->
    <div class="top-header-area">
        <div class="h-100 d-md-flex justify-content-between align-items-center">
            <div class="email-address">
                <a href="mailto:contact@southtemplate.com">contact@southtemplate.com</a>
            </div>
            <div class="phone-number d-flex">
                <div class="icon">
                    <img src="images/icons/phone-call.png" alt="">
                </div>
                <div class="number">
                    <a href="tel:+45 677 8993000 223">+45 677 8993000 223</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Main Header Area -->
    <div class="main-header-area" id="stickyHeader">
        <div class="classy-nav-container breakpoint-off">
            <!-- Classy Menu -->
            <nav class="classy-navbar justify-content-between" id="southNav">

                <!-- Logo -->
                <a class="nav-brand" href="Welcome"><img src="images/core-img/logo.png" alt=""></a>

                <!-- Navbar Toggler -->
                <div class="classy-navbar-toggler">
                    <span class="navbarToggler"><span></span><span></span><span></span></span>
                </div>

                <!-- Menu -->
                <div class="classy-menu">

                    <!-- close btn -->
                    <div class="classycloseIcon">
                        <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                    </div>

                    <!-- Nav Start -->
                    <div class="classynav">
                        <ul>
                            <li><a href="/">Home</a></li>
                            <li><a href="#">About Us</a></li>
                            <li><a href="#">Mega Menu</a>
                                <div class="megamenu">
                                    <ul class="single-mega cn-col-4">
                                        <li class="title">Headline 1</li>
                                        <li><a href="#">Mega Menu Item 1</a></li>
                                        <li><a href="#">Mega Menu Item 2</a></li>
                                        <li><a href="#">Mega Menu Item 3</a></li>
                                        <li><a href="#">Mega Menu Item 4</a></li>
                                        <li><a href="#">Mega Menu Item 5</a></li>
                                    </ul>
                                </div>
                            </li>
                            <li><a href="#">Contact</a></li>
                        </ul>

                    </div>
                    <!-- Nav End -->
                </div>
            </nav>
        </div>
    </div>
</header>
<!-- ##### Header Area End ##### -->
<br><br><br><br><br><br>
<!-- ##### Hero Area Start ##### -->
<section class="hero-area">
    <div class="hero-slides owl-carousel">
        <!-- Single Hero Slide -->
        <div class="single-hero-slide bg-img" style="background-image: url(images/bg-img/hero1.jpg);">
            <div class="container h-100">
                <div class="row h-100 align-items-center">
                    <div class="col-12">
                        <div class="hero-slides-content">
                            <h2 data-animation="fadeInUp" data-delay="100ms">Find your home</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Single Hero Slide -->
        <div class="single-hero-slide bg-img" style="background-image: url(images/bg-img/hero2.jpg);">
            <div class="container h-100">
                <div class="row h-100 align-items-center">
                    <div class="col-12">
                        <div class="hero-slides-content">
                            <h2 data-animation="fadeInUp" data-delay="100ms">Find your dream house</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Single Hero Slide -->
        <div class="single-hero-slide bg-img" style="background-image: url(images/bg-img/hero3.jpg);">
            <div class="container h-100">
                <div class="row h-100 align-items-center">
                    <div class="col-12">
                        <div class="hero-slides-content">
                            <h2 data-animation="fadeInUp" data-delay="100ms">Find your perfect house</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- ##### Hero Area End ##### -->

<!-- ##### Advance Search Area Start ##### -->
<div class="south-search-area">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="advanced-search-form">
                    <!-- Search Title -->
                    <div class="search-title">
                        <p>Search for your home</p>
                    </div>
                    <!-- Search Form -->
                    <form action="/" method="post" id="advanceSearch">
                        <div class="row">

                            <div class="col-12 col-md-4 col-lg-3">
                                <div class="form-group">
                                    <select class="form-control" id="cities">
                                        <option value="-1">-District-</option>
                                       <option>District 1</option>
                                       <option>District 2</option>
                                        <option>District 3</option>
                                        <option>District 4</option>
                                        <option>District 5</option>
                                        <option>District 6</option>
                                        <option>District 7</option>
                                        <option>District 8</option>
                                        <option>District 9</option>
                                        <option>District 10</option>
                                        <option>Binh Thanh district</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-12 col-md-8 col-lg-12 col-xl-5 d-flex">
                                <!-- Space Range -->
                                <div class="slider-range">
                                    <div data-min="12" data-max="30" data-unit=" m2" class="slider-range-price ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" data-value-min="12" data-value-max="30">
                                        <div class="ui-slider-range ui-widget-header ui-corner-all"></div>
                                        <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                        <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                    </div>
                                    <div id="square-range" class="range">12 m2 - 30 m2</div>
                                </div>

                                <!-- Price Range -->
                                <div class="slider-range" id="dady">
                                    <div data-min="1" data-max="5" data-unit=" triệu" class="slider-range-price ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" data-value-min="1" data-value-max="5">
                                        <div class="ui-slider-range ui-widget-header ui-corner-all"></div>
                                        <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                        <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                    </div>
                                    <div id="price-range" class="range">1 triệu - 5 triệu</div>
                                </div>
                            </div>

                            <div class="col-12 d-flex justify-content-between align-items-end">
                                <!-- Submit -->
                                <div class="form-group mb-0">
                                    <button type="button" class="btn south-btn" onclick="search_click()">Search</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- ##### Advance Search Area End ##### -->

<section class="featured-properties-area section-padding-100-50" id="search-result-section" style="display:none">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="section-heading wow fadeInUp">
          <h2>Kết quả tìm kiếm</h2>
        </div>
      </div>
    </div>

    <div class="row" id="searched-house-detail">
    </div>
  </div>
</section>
<!-- ##### Featured Properties Area End ##### -->
<!-- jQuery (Necessary for All JavaScript Plugins) -->
<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>

<!-- Popper js -->
<script src="javascripts/popper.min.js"></script>
<!-- Bootstrap js -->
<script src="javascripts/bootstrap.min.js"></script>
<!-- Plugins js -->
<script src="javascripts/plugins.js"></script>
<script src="javascripts/classy-nav.min.js"></script>
<script src="javascripts/jquery-ui.min.js"></script>
<!-- Active js -->
<script src="javascripts/active.js"></script>
<script src="javascripts/main.js"></script>
</body>

<script type="text/javascript">

function search_click() {
  $('#search-result-section').show();

  var prices = $('#price-range')[0].innerText.replace(/\D+/g, "");
  var squares = $('#square-range')[0].innerText.replace(/\D+/g, "");
  var city = '';
  if ($('#cities')[0].value != -1) {
    city = $('#cities')[0].value;
  }
  //get max price, min prices
  let maxprice = parseInt(prices[1]), minprice = parseInt(prices[0]);
  let maxsquare = parseInt(squares[3]+squares[4]), minsquare = parseInt(squares[0]+squares[1]);

  //query search
  HouseRentingContract.houseCount(function(error, houseCount) {
    for (let i=0; i< parseInt(houseCount); i++) {
      HouseRentingContract.houseStructs(i, function(err, house) {
        if (house !== null && parseInt(house[2]) <= maxsquare && parseInt(house[2]) >= minsquare) {
          var content = '<div class="col-12 col-md-6 col-xl-4">'+
          '<div class="single-featured-property mb-50 wow fadeInUp" data-wow-delay="200ms">'+
            '<div class="property-thumb">'+
              '<img src="images/bg-img/feature2.jpg" alt="" onclick=houseDetail_click(' + i + ')>'+
              '<div class="list-price">'+
                '<p>'+web3.fromWei(parseInt(house[6]),'ether')+' ETH</p>'+
              '</div>'+
            '</div>'+
            '<div class="property-content">'+
            '<h5>'+ house[0] +', '+ house[1] +'</h5>'+
              '<p>'+ house[4] +'</p>'+
              '<div class="property-meta-data d-flex align-items-end justify-content-between">'+
                    '<div class="space">'+
                        '<img src="images/icons/space.png" alt="">'+
                        '<span>'+ parseInt(house[2])+' m2</span>'+
                    '</div>'+
                '</div>'+
            '</div>'+
          '</div>'+
        '</div>';
        $('#searched-house-detail').append(content);
        }
      });
    }
  });
}

function houseDetail_click(houseId) {
  // $.ajax({
  //   method: 'get',
  //   url: 'detail',
  //   data: houseId
  // });
  window.location.href = '/detail?houseId='+houseId;
}
</script>
</html>
